<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agendei</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#7C6CF2;
  --bg:#f5f6fa;
  --card:#ffffff;
  --text:#1e1e2f;
  --muted:#777;
}

body.dark{
  --bg:#111827;
  --card:#1f2937;
  --text:#f9fafb;
  --muted:#9ca3af;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,sans-serif}

body{
  background:var(--bg);
  color:var(--text);
  display:flex;
  height:100vh;
}

.sidebar{
  width:260px;
  background:var(--card);
  padding:30px 20px;
  display:flex;
  flex-direction:column;
  gap:20px;
  border-right:1px solid #eee;
}

.logo{
  font-size:22px;
  font-weight:700;
  color:var(--primary);
}

.menu button{
  background:none;
  border:none;
  padding:12px;
  text-align:left;
  border-radius:8px;
  cursor:pointer;
  font-weight:500;
  color:var(--text);
}

.menu button:hover{
  background:var(--primary);
  color:#fff;
}

.content{
  flex:1;
  padding:40px;
  overflow:auto;
}

.card{
  background:var(--card);
  padding:20px;
  border-radius:12px;
  margin-bottom:20px;
}

.grid{
  display:grid;
  gap:20px;
}

.grid-3{
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
}

input,select{
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid #ddd;
  margin-top:5px;
}

button.primary{
  background:var(--primary);
  border:none;
  padding:10px;
  color:#fff;
  border-radius:8px;
  cursor:pointer;
}

.table{
  width:100%;
  border-collapse:collapse;
}

.table th,.table td{
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:left;
}

.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}

@media(max-width:900px){
  body{flex-direction:column}
  .sidebar{width:100%;flex-direction:row;overflow:auto}
  .menu{display:flex;gap:10px}
  .content{padding:20px}
}
</style>
</head>
<body>

<div class="sidebar">
<div class="logo">Agendei</div>
<div class="menu">
<button onclick="showTab('dashboard')">Dashboard</button>
<button onclick="showTab('agendar')">Agendar</button>
<button onclick="showTab('agendamentos')">Agendei</button>
<button onclick="showTab('config')">Configurações</button>
</div>
<button onclick="toggleDark()">Modo Escuro</button>
<button onclick="logout()">Sair</button>
</div>

<div class="content">

<div id="dashboard" class="tab">
<div class="topbar">
<h2>Painel</h2>
</div>
<div class="grid grid-3">
<div class="card"><h3>Total Hoje</h3><p id="totalHoje">R$0</p></div>
<div class="card"><h3>Agendamentos Hoje</h3><p id="qtdHoje">0</p></div>
<div class="card"><h3>Pendentes</h3><p id="pendentes">0</p></div>
</div>
</div>

<div id="agendar" class="tab" style="display:none">
<div class="card">
<h3>Novo Agendamento</h3>
<input id="clienteNome" placeholder="Nome do Cliente">
<input id="clienteWhats" placeholder="WhatsApp Cliente">
<select id="servicoSelect"></select>
<select id="profissionalSelect"></select>
<input type="date" id="data">
<input type="time" id="hora">
<button class="primary" onclick="salvarAgendamento()">Agendar</button>
</div>
</div>

<div id="agendamentos" class="tab" style="display:none">
<div class="card">
<h3>Lista</h3>
<table class="table">
<thead>
<tr>
<th>Cliente</th>
<th>Serviço</th>
<th>Profissional</th>
<th>Data</th>
<th>Status</th>
</tr>
</thead>
<tbody id="listaAgendamentos"></tbody>
</table>
</div>
</div>

<div id="config" class="tab" style="display:none">
<div class="card">
<h3>Adicionar Serviço</h3>
<input id="novoServicoNome" placeholder="Nome">
<input id="novoServicoValor" placeholder="Valor">
<input id="novoServicoDuracao" placeholder="Duração (min)">
<button class="primary" onclick="addServico()">Salvar</button>
</div>

<div class="card">
<h3>Adicionar Profissional</h3>
<input id="novoProfNome" placeholder="Nome">
<input id="novoProfWhats" placeholder="WhatsApp">
<button class="primary" onclick="addProfissional()">Salvar</button>
</div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-app.js";
import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyAxyovmqjNYIzOYYDZZnduquiJQeK4UIgc",
authDomain: "agendei-d721e.firebaseapp.com",
projectId: "agendei-d721e",
storageBucket: "agendei-d721e.firebasestorage.app",
messagingSenderId: "525023801595",
appId: "1:525023801595:web:71a6d72e986e6e9e30005e",
measurementId: "G-YQP41N6MJ3"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

window.showTab = function(tab){
document.querySelectorAll('.tab').forEach(t=>t.style.display='none');
document.getElementById(tab).style.display='block';
}

window.toggleDark = function(){
document.body.classList.toggle('dark');
localStorage.setItem('dark',document.body.classList.contains('dark'));
}

if(localStorage.getItem('dark')==='true'){
document.body.classList.add('dark');
}

window.logout = function(){
signOut(auth).then(()=>location.reload());
}

window.salvarAgendamento = async function(){
await addDoc(collection(db,"agendamentos"),{
cliente:clienteNome.value,
whats:clienteWhats.value,
servico:servicoSelect.value,
profissional:profissionalSelect.value,
data:data.value,
hora:hora.value,
status:"pendente"
});
alert("Agendado!");
location.reload();
}

window.addServico = async function(){
await addDoc(collection(db,"servicos"),{
nome:novoServicoNome.value,
valor:novoServicoValor.value,
duracao:novoServicoDuracao.value
});
alert("Salvo");
location.reload();
}

window.addProfissional = async function(){
await addDoc(collection(db,"profissionais"),{
nome:novoProfNome.value,
whats:novoProfWhats.value
});
alert("Salvo");
location.reload();
}

async function carregar(){
let serv = await getDocs(collection(db,"servicos"));
serv.forEach(doc=>{
servicoSelect.innerHTML+=`<option>${doc.data().nome}</option>`;
});

let prof = await getDocs(collection(db,"profissionais"));
prof.forEach(doc=>{
profissionalSelect.innerHTML+=`<option>${doc.data().nome}</option>`;
});

let ag = await getDocs(collection(db,"agendamentos"));
ag.forEach(doc=>{
let d=doc.data();
listaAgendamentos.innerHTML+=`
<tr>
<td>${d.cliente}</td>
<td>${d.servico}</td>
<td>${d.profissional}</td>
<td>${d.data} ${d.hora}</td>
<td>${d.status}</td>
</tr>`;
});
}

carregar();
</script>

</body>
</html>
