<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agendei</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
--primary:#c084fc;
--secondary:#a5b4fc;
--bg:#f8fafc;
--card:#ffffff;
--text:#1e293b;
--border:#e2e8f0;
}

.dark{
--bg:#0f172a;
--card:#1e293b;
--text:#f1f5f9;
--border:#334155;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Inter;}

body{
background:var(--bg);
color:var(--text);
display:flex;
min-height:100vh;
}

/* SIDEBAR */

.sidebar{
width:240px;
background:linear-gradient(180deg,var(--primary),var(--secondary));
padding:30px 20px;
color:white;
display:flex;
flex-direction:column;
}

.logo{
font-size:22px;
font-weight:700;
margin-bottom:40px;
}

.nav-btn{
background:none;
border:none;
color:white;
padding:12px 10px;
text-align:left;
cursor:pointer;
border-radius:8px;
transition:0.2s;
}

.nav-btn:hover{
background:rgba(255,255,255,0.15);
}

.main{
flex:1;
padding:40px;
max-width:1200px;
margin:auto;
width:100%;
}

.header{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:30px;
}

.card{
background:var(--card);
border:1px solid var(--border);
padding:25px;
border-radius:16px;
box-shadow:0 5px 20px rgba(0,0,0,0.05);
margin-bottom:20px;
}

.button{
background:linear-gradient(90deg,var(--primary),var(--secondary));
color:white;
border:none;
padding:10px 16px;
border-radius:8px;
cursor:pointer;
font-weight:500;
}

input,select{
width:100%;
padding:10px;
border-radius:8px;
border:1px solid var(--border);
margin-top:10px;
}

/* MODAL */

.modal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.4);
display:flex;
justify-content:center;
align-items:center;
visibility:hidden;
opacity:0;
transition:0.3s;
}

.modal.active{
visibility:visible;
opacity:1;
}

.modal-content{
background:var(--card);
padding:30px;
border-radius:16px;
width:95%;
max-width:400px;
}

/* RESPONSIVO */

@media(max-width:900px){
.sidebar{
position:fixed;
height:100%;
left:-260px;
transition:0.3s;
z-index:10;
}

.sidebar.active{
left:0;
}

.main{
padding:20px;
}
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginScreen" style="margin:auto;width:100%;max-width:400px;">
<div class="card">
<h2 style="text-align:center;margin-bottom:20px;">Agendei</h2>
<input id="email" placeholder="Email">
<input id="senha" type="password" placeholder="Senha">
<button class="button" onclick="login()">Entrar</button>
</div>
</div>

<!-- APP -->
<div id="appScreen" style="display:none;width:100%;">

<div class="sidebar">
<div class="logo">Agendei</div>
<button class="nav-btn" onclick="showTab('agendar')">Agendar</button>
<button class="nav-btn" onclick="showTab('agendamentos')">Agendamentos</button>
<button class="nav-btn" onclick="showTab('config')">Configurações</button>
<button class="nav-btn" onclick="toggleDark()">Modo Escuro</button>
<button class="nav-btn" onclick="logout()">Sair</button>
</div>

<div class="main">

<div class="header">
<h2 id="titulo"></h2>
<button class="button" onclick="openModal()">Novo</button>
</div>

<div id="conteudo"></div>

</div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
<div class="modal-content" id="modalContent"></div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyAxyovmqjNYIzOYYDZZnduquiJQeK4UIgc",
authDomain: "agendei-d721e.firebaseapp.com",
projectId: "agendei-d721e",
storageBucket: "agendei-d721e.firebasestorage.app",
messagingSenderId: "525023801595",
appId: "1:525023801595:web:71a6d72e986e6e9e30005e"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const loginScreen = document.getElementById("loginScreen");
const appScreen = document.getElementById("appScreen");

window.login = async function(){
await signInWithEmailAndPassword(auth,email.value,senha.value);
}

window.logout = function(){
signOut(auth);
}

onAuthStateChanged(auth,(user)=>{
if(user){
loginScreen.style.display="none";
appScreen.style.display="flex";
showTab("agendar");
}else{
loginScreen.style.display="block";
appScreen.style.display="none";
}
});

window.showTab = async function(tab){
document.getElementById("titulo").innerText =
tab==="agendar"?"Agendar":
tab==="agendamentos"?"Agendamentos":
"Configurações";

const conteudo = document.getElementById("conteudo");
conteudo.innerHTML="";

if(tab==="agendar"){
conteudo.innerHTML=`
<div class="card">
<input id="cliente" placeholder="Nome do Cliente">
<input id="data" type="date">
<input id="hora" type="time">
<input id="servico" placeholder="Serviço">
<input id="profissional" placeholder="Profissional">
<button class="button" onclick="salvarAgendamento()">Salvar</button>
</div>`;
}

if(tab==="agendamentos"){
const query = await getDocs(collection(db,"agendamentos"));
query.forEach(doc=>{
let d=doc.data();
conteudo.innerHTML+=`
<div class="card">
<strong>${d.data} ${d.hora}</strong><br>
Cliente: ${d.cliente}<br>
Serviço: ${d.servico}<br>
Profissional: ${d.profissional}
</div>`;
});
}

if(tab==="config"){
conteudo.innerHTML=`
<div class="card">
<p>Configurações serão organizadas aqui (serviços, profissionais, horários, mensagens).</p>
</div>`;
}
}

window.salvarAgendamento = async function(){
await addDoc(collection(db,"agendamentos"),{
cliente:cliente.value,
data:data.value,
hora:hora.value,
servico:servico.value,
profissional:profissional.value
});
showTab("agendamentos");
}

window.openModal=function(){
document.getElementById("modalContent").innerHTML=
`<h3 style="margin-bottom:15px;">Em desenvolvimento</h3>
<p>Próxima etapa: CRUD completo organizado.</p>`;
document.getElementById("modal").classList.add("active");
}

window.toggleDark=function(){
document.body.classList.toggle("dark");
}

document.getElementById("modal").addEventListener("click",e=>{
if(e.target.id==="modal"){
e.target.classList.remove("active");
}
});

</script>

</body>
</html>
